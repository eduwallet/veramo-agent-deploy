basic_applications:
  - nano
  - git
  - docker-ce
  - docker-ce-cli
  - containerd.io
  - docker-compose-plugin

basedir: /opt/agent

# All domains that we must generate ssl certificates for. The deploy domain and any domain listed
# in dids
ssl_domains: "{{ [basedomain] + dids | map(attribute='domain') }}"
# SSL domains turned into a string for docker-compose traefik labels:
# Host(`sub.example.com`) || Host(`foo.sub.example.ecom`) etc. Note the backtick.
traefik_hosts_string:  "{{ ssl_domains | map('regex_replace', '(.+)', 'Host(`\\1`)') | join(' || ') }}"

traefik:
  enabled: true
  secure: "{{ enablehttps }}"
  postmaster: certbot@muisit.nl
  expose: true

# This is a generic deploy token for the veramo-agent gitlab application. As long as this ansible only deploys
# exactly that gitlab repository, the token can be used by all environments
deployuser: gitlab+deploy-token-43
deploytoken: !vault |
             $ANSIBLE_VAULT;1.1;AES256
             66356166626332356561643739626332363230316538356563653366643166383461343237363562383937333138313561
             6661303166613335363262656636360a663932626432353561653237646164393732643865333064353439636162666332
             663234633536623832343338336564353265656665386462343936396263310a3237363562656264326335613264316231
             3432623561313666316537366634366662643239633432643830363138393234646364343563363737646362623032

sources:
  agent:
    repo: "https://{{ deployuser }}:{{ deploytoken }}@gitlab.surf.nl/eduwallet/veramo-agent.git"
    version: HEAD

docker:
  dir: "{{ basedir }}/docker"

agent:
  dir: "{{ basedir }}/agent"
  script: "start:dev"
  hostname: "{{ basedomain }}"
  port: 5000
  host: "{{ protocol }}://agent.{{ basedomain }}"
  dbkey: !vault |
         $ANSIBLE_VAULT;1.1;AES256
         613138333438633365356562313765626263373936373561623332333236353735343636633062376463623231353365386632
         626534646336363265386539620a66636131333232353464303834363639306239373363393832346235653735363564383131
         6638373737363863363835623264343633623866646337653436640a3730653334646265306633353930623430303031666533
         646334343834623734643834316635386662316136393035376261353933626337383232383964393665663731313865303462
         38343065623530646162336236656339663564663131

database:
  dir: "{{ basedir }}/database"
  port: 5001
  user: postgres
  name: postgres
  schema: agent
  scripts: "{{ basedir }}/agent/scripts/dbinit"
  password: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            32316666393534373962666266303663623938633838356132343731643231666464356264626237303339
            6265336337663166663035363035663065346463320a613734323539633230613034636563353762623034
            35343139366336613032663732646237383561343538373438306133316363363139313336623739306130
            0a363133356630373263663736396137643535643033613130623536386334613265323831303065643835
            32643637343539303064373636396463613231643861316464613461303337303265386530386332626664
            3437343734373764363130
